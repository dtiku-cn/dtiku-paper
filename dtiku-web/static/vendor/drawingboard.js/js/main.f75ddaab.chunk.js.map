{"version":3,"sources":["utils/svg/createLineUtil.js","utils/svg/createPathUtil.js","utils/svg/createRectUtil.js","utils/svg/createCircleUtil.js","utils/svg/createTriangleUtil.js","utils/svg/createBesselUtil.js","utils/freeHandPencil.js","utils/svg/createFreeHandPathUtil.js","utils/svg/createSvgChildUtil.js","utils/unload.js","utils/saveToIndexDbUtil.js","utils/readIndexDbUtil.js","utils/deleteItemUtil.js","components/drawingBox/index.js","components/colorSelector/index.js","components/figureSelector/index.js","components/propsSelector/index.js","utils/figuresOperateUtil.js","components/figuresOperate/index.js","components/handlerMode/index.js","components/controlsBar/index.js","App.js","utils/reduxUtil.js","reportWebVitals.js","index.js"],"names":["createLine","e","figure","nativeEvent","moveX","offsetX","moveY","offsetY","renderLine","index","downX","downY","color","width","fill","x1","x2","y1","y2","stroke","strokeLinecap","strokeLinejoin","strokeWidth","createPath","path","renderPath","newPath","d","createRect","renderRect","rectWidth","rectHeight","x","y","height","createCircle","cx","cy","r","Math","max","abs","renderCircle","createTriangle","renderTriangle","pointsStr","points","createBessel","renderBessel","getComponentSvgPath","options","size","getStroke","length","reduce","acc","i","arr","x0","y0","push","join","createFreeHandPath","thinning","smoothing","streamline","start","taper","end","createSvgChildUtil","item","type","getPath","useUnload","fn","cb","useRef","useEffect","onUnload","current","window","addEventListener","removeEventListener","handleOpenSuccess","result","target","this","callback","id","data","onsuccess","onerror","request","transaction","objectStore","add","handleUpgrade","console","info","objectStoreNames","contains","createObjectStore","keyPath","handleOpenError","error","saveToIndexDb","indexedDB","open","onupgradeneeded","handleSuccess","get","handleError","readIndexDb","delete","deleteItem","onTouch","onPainting","updated","requested","newFigures","lastMove","DrawingBox","newAction","useDispatch","useState","setFigure","useSelector","state","drawingStyle","activeSelector","handlerMode","figures","handleMouseDown","key","Date","now","updateComponent","handleMouseMove","flag","handleDrawing","requestAnimationFrame","handleMouseUp","lastFigure","touchToMouse","touches","pageX","pageY","container","includes","tagName","parentElement","offsetLeft","offsetTop","localStorage","setItem","JSON","stringify","location","pathname","lastDrawingBoard","getItem","parse","className","onTouchEnd","preventDefault","onTouchMove","id1","identifier","id2","y01","y02","scrollBy","top","behavior","moveBy2Touch","onMouseUp","onMouseDown","onMouseMove","onMouseLeave","map","colors","ColorSelector","onClick","viewBox","xmlns","dataset","style","backgroundColor","shapes","freeHand","triangle","circle","rect","line","arc","FigureSelector","Object","entries","value","PropsSelector","onChange","Number","min","checked","htmlFor","FiguresBak","recoveryStack","cancelStack","clearFlag","prototype","addStatus","backStatus","tmp","pop","recStatus","clearAllStack","Figures","FiguresOperate","cancel","setCancel","recover","setRecover","handlerModePaths","HandlerMode","onMove","lastX","lastY","ToolBar","wrapRef","transX","transY","transform","setTransform","innerWidth","innerHeight","onWheel","stopPropagation","scrollTo","left","scrollLeft","deltaY","ref","deltaX","newTransX","newTransY","transition","App","configKey","defaultState","store","createStore","action","forEach","f","lastStatus","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f75ddaab.chunk.js","sourcesContent":["function createLine(e, figure) {\n  const { nativeEvent } = e;\n  figure.moveX = nativeEvent.offsetX;\n  figure.moveY = nativeEvent.offsetY;\n}\n\nfunction renderLine(figure, index) {\n  const { downX, downY, moveX, moveY, color, width, fill } = figure;\n  if (!moveX) return;\n  return (\n    <line\n      x1={downX}\n      x2={moveX}\n      y1={downY}\n      y2={moveY}\n      key={index}\n      stroke={color}\n      fill={fill}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={width}\n    />\n  );\n}\n\nexport { createLine, renderLine };\n","function createPath(e, figure) {\n  const { nativeEvent } = e;\n  figure.path += `L${nativeEvent.offsetX} ${nativeEvent.offsetY}`;\n}\n\nfunction renderPath(figure, index) {\n  const { path, color, width, downX, downY } = figure;\n  if (!path) return null;\n  const newPath = `M${downX} ${downY} ` + path;\n  return (\n    <path\n      stroke={color}\n      strokeWidth={width}\n      fill=\"transparent\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d={newPath}\n      key={index}\n    />\n  );\n}\n\nexport { createPath, renderPath };\n","function createRect(e, figure) {\n  const { nativeEvent } = e;\n  figure.moveX = nativeEvent.offsetX;\n  figure.moveY = nativeEvent.offsetY;\n}\n\nfunction renderRect(figure, index) {\n  const { color, fill, width } = figure;\n  let { downX, downY, moveX, moveY } = figure;\n  if (!moveX) return;\n  let rectWidth = moveX - downX,\n    rectHeight = moveY - downY;\n  if (rectWidth < 0) {\n    downX += rectWidth;\n    rectWidth = -rectWidth;\n  }\n  if (rectHeight < 0) {\n    downY += rectHeight;\n    rectHeight = -rectHeight;\n  }\n  return (\n    <rect\n      x={downX}\n      y={downY}\n      width={rectWidth}\n      height={rectHeight}\n      key={index}\n      stroke={color}\n      fill={fill}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={width}\n    />\n  );\n}\n\nexport { createRect, renderRect };\n","function createCircle(e, figure) {\n  const { nativeEvent } = e;\n  const { downX, downY } = figure;\n  figure.cx = (downX + nativeEvent.offsetX) / 2;\n  figure.cy = (downY + nativeEvent.offsetY) / 2;\n  figure.r = Math.max(\n    Math.abs(nativeEvent.offsetX - downX),\n    Math.abs(nativeEvent.offsetY - downY)\n  ) / 2;\n}\n\nfunction renderCircle(figure, index) {\n  const { cx, cy, r, color, fill, width } = figure;\n  return (\n    <circle\n      r={r}\n      cx={cx}\n      cy={cy}\n      key={index}\n      stroke={color}\n      fill={fill}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={width}\n    />\n  );\n}\n\nexport { createCircle, renderCircle };\n","function createTriangle(e, figure) {\n  const { nativeEvent } = e;\n  figure.moveX = nativeEvent.offsetX;\n  figure.moveY = nativeEvent.offsetY;\n}\n\nfunction renderTriangle(figure, index) {\n  const { downX, downY, moveX, moveY, color, width, fill } = figure;\n  if (!moveX) return;\n  const pointsStr = `${(downX + moveX) / 2} ${downY},${downX} ${moveY},${moveX} ${moveY}`;\n  return (\n    <polygon\n      key={index}\n      stroke={color}\n      points={pointsStr}\n      fill={fill}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={width}\n    />\n  );\n}\n\nexport { createTriangle, renderTriangle };\n","function createBessel(e, figure) {\n  const { nativeEvent } = e;\n  figure.path = ` Q ${nativeEvent.offsetX} ${figure.downY} ${nativeEvent.offsetX} ${nativeEvent.offsetY}`;\n}\n\nfunction renderBessel(figure, index) {\n  const { color, width, downX, downY, path } = figure;\n  const newPath = `M${downX} ${downY} ` + path;\n  return (\n    <path\n      stroke={color}\n      strokeWidth={width}\n      fill=\"transparent\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d={newPath}\n      key={index}\n    />\n  );\n}\n\nexport { createBessel, renderBessel };\n","import { getStroke } from 'perfect-freehand'\n\n/**\n * https://github.com/tldraw/tldraw/blob/main/examples/core-example-advanced/src/shapes/pencil/pencil-helpers.ts\n */\nfunction getComponentSvgPath(points, options = { size: 8 }) {\n  const stroke = getStroke(points, options)\n\n  if (!stroke.length) return ''\n\n  const d = stroke.reduce(\n    (acc, [x0, y0], i, arr) => {\n      const [x1, y1] = arr[(i + 1) % arr.length]\n      acc.push(x0, y0, (x0 + x1) / 2, (y0 + y1) / 2)\n      return acc\n    },\n    ['M', ...stroke[0], 'Q']\n  )\n\n  d.push('Z')\n  return d.join(' ')\n}\n\nexport default getComponentSvgPath;","import getComponentSvgPath from \"../freeHandPencil\"\n\nlet points\n\nfunction createFreeHandPath(e, figure) {\n    const { path, width, downX, downY } = figure;\n    const { nativeEvent } = e;\n    if (!path) {\n        points = [[downX, downY]];\n    }\n    points.push([nativeEvent.offsetX, nativeEvent.offsetY]);\n    figure.path = getComponentSvgPath(points, {\n        size: width,\n        thinning: 0.5,\n        smoothing: 0.5,\n        streamline: 0.5,\n        start: { taper: 1 },\n        end: { taper: 1 },\n    });\n}\n\nfunction renderFreeHandPath(figure, index) {\n    const { path, color } = figure;\n    if (!path) return null;\n    return (\n        <path\n            fill={color}\n            d={path}\n            key={index}\n        />\n    );\n}\n\nexport { createFreeHandPath, renderFreeHandPath };\n","import { renderPath } from \"./createPathUtil\";\nimport { renderLine } from \"./createLineUtil\";\nimport { renderRect } from \"./createRectUtil\";\nimport { renderCircle } from \"./createCircleUtil\";\nimport { renderTriangle } from \"./createTriangleUtil\";\nimport { renderBessel } from \"./createBesselUtil\";\n\nfunction createSvgChildUtil(item, index) {\n  const { type } = item;\n  if (type === \"empty\") return null;\n  let getPath = function () { };\n  if (type === \"path\") getPath = renderPath;\n  else if (type === \"freeHand\") getPath = renderPath;\n  else if (type === \"line\") getPath = renderLine;\n  else if (type === \"rect\") getPath = renderRect;\n  else if (type === \"circle\") getPath = renderCircle;\n  else if (type === \"triangle\") getPath = renderTriangle;\n  else if (type === \"arc\") getPath = renderBessel;\n  else return null;\n  return getPath(item, index);\n}\n\nexport default createSvgChildUtil;\n","import { useRef, useEffect } from \"react\";\n\nconst useUnload = fn => {\n    const cb = useRef(fn);\n\n    useEffect(() => {\n        const onUnload = cb.current;\n        window.addEventListener('unload', onUnload);\n        return () => {\n            window.removeEventListener('unload', onUnload);\n        };\n    }, [cb]);\n};\n\nexport default useUnload;","function handleOpenSuccess({ target: { result } }) {\n  const { id, data, onsuccess, onerror } = this.callback;\n  const transaction = result.transaction(\"figures\", \"readwrite\");\n  const store = transaction.objectStore(\"figures\");\n  const request = store.add({ id, data });\n  request.onerror = onerror;\n  request.onsuccess = onsuccess;\n}\n\nfunction handleUpgrade({ target: { result } }) {\n  console.info(\"尝试创建数据库\");\n  if (!result.objectStoreNames.contains(\"figures\")) {\n    result.createObjectStore(\"figures\", { keyPath: \"id\" });\n  }\n}\n\nfunction handleOpenError() {\n  console.error(\"数据库连接失败\");\n  this.callback.onerror();\n}\n\nfunction saveToIndexDb(id, data, onsuccess, onerror) {\n  const request = indexedDB.open(\"drawing-board\", 3);\n  request.callback = { id, data, onsuccess, onerror };\n  request.onsuccess = handleOpenSuccess;\n  request.onerror = handleOpenError;\n  request.onupgradeneeded = handleUpgrade;\n}\n\nexport default saveToIndexDb;\n","function handleSuccess({ target: { result } }) {\n  const { id, onsuccess, onerror } = this.callback;\n  const transaction = result.transaction(\"figures\");\n  const store = transaction.objectStore(\"figures\");\n  const request = store.get(id);\n  request.onerror = onerror;\n  request.onsuccess = function (e) {\n    if (e.target.result) {\n      onsuccess(e.target.result);\n    }\n  };\n}\n\nfunction handleError() {\n  console.error(\"数据库连接失败\");\n  this.callback.onerror();\n}\n\nfunction handleUpgrade({ target: { result } }) {\n  console.info(\"尝试创建数据库\");\n  if (!result.objectStoreNames.contains(\"figures\")) {\n    result.createObjectStore(\"figures\", { keyPath: \"id\" });\n  }\n}\n\nfunction readIndexDb(id, onsuccess, onerror) {\n  const request = indexedDB.open(\"drawing-board\", 3);\n  request.callback = { id, onsuccess, onerror };\n  request.onsuccess = handleSuccess;\n  request.onerror = handleError;\n  request.onupgradeneeded = handleUpgrade;\n}\n\nexport default readIndexDb;","function handleSuccess({ target: { result } }) {\n  const { id, onsuccess, onerror } = this.callback;\n  const transaction = result.transaction(\"figures\", \"readwrite\");\n  const store = transaction.objectStore(\"figures\");\n  const request = store.delete(id);\n  request.onerror = onerror;\n  request.onsuccess = onsuccess;\n}\n\nfunction handleError() {\n  console.error(\"数据库连接失败\");\n  this.callback.onerror();\n}\n\nfunction deleteItem(id, onsuccess, onerror) {\n  const request = indexedDB.open(\"drawing-board\", 3);\n  request.callback = { id, onsuccess, onerror };\n  request.onsuccess = handleSuccess;\n  request.onerror = handleError;\n}\n\nexport default deleteItem;\n","import \"./index.css\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport React, { useEffect, useState, Fragment } from \"react\";\nimport { createLine } from \"../../utils/svg/createLineUtil\";\nimport { createPath } from \"../../utils/svg/createPathUtil\";\nimport { createRect } from \"../../utils/svg/createRectUtil\";\nimport { createCircle } from \"../../utils/svg/createCircleUtil\";\nimport { createTriangle } from \"../../utils/svg/createTriangleUtil\";\nimport { createBessel } from \"../../utils/svg/createBesselUtil\";\nimport { createFreeHandPath } from \"../../utils/svg/createFreeHandPathUtil\";\nimport createSvgChildUtil from \"../../utils/svg/createSvgChildUtil\";\nimport useUnload from \"../../utils/unload\";\nimport saveToIndexDb from \"../../utils/saveToIndexDbUtil\";\nimport readIndexDb from \"../../utils/readIndexDbUtil\";\nimport deleteItem from \"../../utils/deleteItemUtil\";\n\nlet onTouch = false;\nlet onPainting = false;\nlet updated = false;\nlet requested = false;\n\nlet newFigures = null;\nlet lastMove = null;\n\nfunction DrawingBox() {\n  const newAction = useDispatch();\n  const [figure, setFigure] = useState({});\n  const { drawingStyle, activeSelector, handlerMode } = useSelector((state) => state);\n  const { figures } = useSelector((state) => state);\n\n  newFigures = figures;\n  useUnload(function () {\n    localStorage.setItem(\"lastDrawingBoard\", JSON.stringify({ id: location.pathname, figures: newFigures }));\n  })\n\n  useEffect(() => {\n    const lastDrawingBoard = localStorage.getItem(\"lastDrawingBoard\");\n    if (lastDrawingBoard) {\n      const { id, figures } = JSON.parse(lastDrawingBoard);\n      if (id === location.pathname) {\n        newAction({ type: \"INIT_FIGURES\", figures });\n        return;\n      } else {\n        deleteItem(id, () => saveToIndexDb(id, figures));\n      }\n    }\n    readIndexDb(location.pathname, ({ data }) => {\n      if (data) {\n        newAction({ type: \"INIT_FIGURES\", figures: data });\n      }\n    });\n  }, []);\n\n  function handleMouseDown(e) {\n    onPainting = true;\n    const { nativeEvent } = e;\n    const { color, width, fill } = drawingStyle;\n    figure.color = color;\n    figure.width = width;\n    figure.fill = fill;\n    figure.path = \"\";\n    figure.type = drawingStyle.type;\n    figure.key = Date.now();\n    figure.downX = nativeEvent.offsetX;\n    figure.downY = nativeEvent.offsetY;\n  }\n\n  function updateComponent() {\n    requested = true;\n    setFigure({ ...figure });\n  }\n\n  function handleMouseMove(e) {\n    if (activeSelector !== '') {\n      newAction({\n        type: \"SET_ACTIVE_SELECTOR\",\n        activeSelector: ''\n      });\n    }\n    if (!onPainting) return;\n    figure.flag = true;\n    let handleDrawing = function () { };\n    const { type } = drawingStyle;\n    if (type === \"path\") handleDrawing = createPath;\n    else if (type === 'freeHand') handleDrawing = createFreeHandPath;\n    else if (type === \"line\") handleDrawing = createLine;\n    else if (type === \"rect\") handleDrawing = createRect;\n    else if (type === \"circle\") handleDrawing = createCircle;\n    else if (type === \"triangle\") handleDrawing = createTriangle;\n    else if (type === \"arc\") handleDrawing = createBessel;\n    handleDrawing(e, figure);\n    if (!updated) {\n      updated = true;\n      requestAnimationFrame(updateComponent);\n    }\n  }\n\n  function handleMouseUp() {\n    if (onTouch) return;\n    onPainting = false;\n    if (!figure?.flag) return;\n    const lastFigure = { end: true, ...figure };\n    figure.type = \"\";\n    newAction({ type: \"ADD_NEW_FIGURE\", figure: lastFigure });\n  }\n\n  function touchToMouse(e) {\n    const {\n      target,\n      touches: [{ pageX, pageY }],\n    } = e;\n    const container = ['path', 'circle', 'line', 'rect', 'polygon'].includes(target.tagName) ?\n      target.parentElement.parentElement : target.parentElement\n    const offsetX = pageX - container.offsetLeft;\n    const offsetY = pageY - container.offsetTop;\n    return { nativeEvent: { offsetX, offsetY } };\n  }\n\n  function handleTouchEnd(e) {\n    lastMove = null;\n    if (!onPainting) return true;\n    e.preventDefault();\n    onTouch = false;\n    handleMouseUp();\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length === 2) {\n      moveBy2Touch(e.touches);\n      return;\n    }\n    if (onTouch) {\n      handleMouseMove(touchToMouse(e));\n    } else {\n      onTouch = true;\n      handleMouseDown(touchToMouse(e));\n    }\n  }\n\n  function moveBy2Touch([{ identifier: id1, pageY: y1 }, { identifier: id2, pageY: y2 }]) {\n    if (!!lastMove) {\n      const [y01] = lastMove[id1], [y02] = lastMove[id2];\n      if (Math.abs(y01 - y1) > Math.abs(y02 - y2)) {\n        scrollBy({ top: y01 - y1, behavior: 'smooth' });\n      } else {\n        scrollBy({ top: y02 - y2, behavior: 'smooth' });\n      }\n    }\n    lastMove = { [id1]: [y1], [id2]: [y2] };\n  }\n\n  function handleMouseLeave() {\n    onPainting = false;\n  }\n\n  useEffect(function () {\n    if (requested) {\n      updated = false;\n      requested = false;\n    }\n  }, [figure]);\n  return (\n    <Fragment>\n      <svg\n        className=\"drawing-box\"\n        onTouchEnd={handleTouchEnd}\n        onTouchMove={handleTouchMove}\n        onMouseUp={handleMouseUp}\n        onMouseDown={handleMouseDown}\n        onMouseMove={handleMouseMove}\n        onMouseLeave={handleMouseLeave}\n      >\n        {figures.map((item, index) => createSvgChildUtil(item, index))}\n        {createSvgChildUtil(figure)}\n      </svg>\n      {handlerMode === 'handler' ? <div className=\"drawing-mask\"></div> : null}\n    </Fragment>\n  );\n}\nexport default DrawingBox;\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nconst colors = [\"#ff776d\", \"#020826\", \"#8c7851\", \"#008eff\", \"orange\"];\n\nfunction ColorSelector() {\n  const newAction = useDispatch();\n  const { drawingStyle, activeSelector } = useSelector((state) => state);\n\n  function handleClick({ target }) {\n    const { dataset } = target;\n    if (!dataset.color) return;\n    drawingStyle.color = dataset.color;\n    if (drawingStyle.fill !== \"transparent\") drawingStyle.fill = dataset.color;\n    newAction({ type: \"SET_DRAWING_STYLE\", style: drawingStyle });\n  }\n  function toggleSelector() {\n    newAction({\n      type: \"SET_ACTIVE_SELECTOR\",\n      activeSelector: activeSelector === 'color-selector' ? '' : 'color-selector'\n    });\n  }\n  return (\n    <div className={activeSelector === 'color-selector' ? \"tool-bar-group active-group\" : \"tool-bar-group\"}\n      onClick={toggleSelector}>\n      <svg className=\"tool-bar-item\" viewBox=\"0 0 1024 1024\"\n        xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\n        <path d=\"M852.456667 216.746667A452.693333 452.693333 0 0 0 526.90999999 85.333333a426.666667 426.666667 0 0 0-2.133333 853.333334 110.08 110.08 0 0 0 107.946666-80.64 107.52 107.52 0 0 0-24.31999999-97.28 21.333333 21.333333 0 0 1 15.786667-35.413334h70.39999999A262.4 262.4 0 0 0 957.41666699 483.413333a361.813333 361.813333 0 0 0-104.96-266.666666zM696.296667 640h-70.4a106.24 106.24 0 0 0-79.786667 177.066667 20.906667 20.906667 0 0 1 5.12 20.906666c-2.133333 8.96-11.946667 14.506667-25.173333 15.36a341.333333 341.333333 0 0 1-333.653334-388.693333A345.6 345.6 0 0 1 527.336667 170.666667H530.75a361.386667 361.386667 0 0 1 260.266667 105.813333 277.333333 277.333333 0 0 1 81.066666 203.52A177.92 177.92 0 0 1 696.296667 640z\" p-id=\"996\"></path><path d=\"M530.75 277.333333m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\" p-id=\"997\"></path>\n        <path d=\"M669.41666699 307.2a64 64 0 1 0 87.46666601 23.466667 64 64 0 0 0-87.46666601-23.466667zM392.083333 307.2a64 64 0 1 0 23.466667 87.466667 64 64 0 0 0-23.466667-87.466667zM281.576667 480.426667a64 64 0 1 0 88.746666 17.066666 63.573333 63.573333 0 0 0-88.746666-17.066666z\"></path>\n      </svg>\n      <div className=\"tool-bar-popover\" onClick={handleClick}>\n        {colors.map((item, index) => {\n          return (\n            <span\n              className=\"tool-bar-item\"\n              style={{ backgroundColor: item }}\n              data-color={item}\n              key={index}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nexport default ColorSelector;\n","import \"./index.css\";\nimport React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nexport const shapes = {\n  path: {\n    path: <path d=\"M938.666667 308.906667a42.666667 42.666667 0 0 0-12.373334-30.293334l-180.906666-180.906666a42.666667 42.666667 0 0 0-30.293334-12.373334 42.666667 42.666667 0 0 0-30.293333 12.373334l-120.746667 120.746666L97.706667 684.8a42.666667 42.666667 0 0 0-12.373334 30.293333V896a42.666667 42.666667 0 0 0 42.666667 42.666667h180.906667a42.666667 42.666667 0 0 0 32.426666-12.373334l463.786667-466.346666L926.293333 341.333333a50.773333 50.773333 0 0 0 9.386667-14.08 42.666667 42.666667 0 0 0 0-10.24 29.866667 29.866667 0 0 0 0-5.973333zM291.413333 853.333333H170.666667v-120.746666l423.68-423.68 120.746666 120.746666zM775.253333 369.493333l-120.746666-120.746666 60.586666-60.16 120.32 120.32z\"></path>\n  },\n  freeHand: {\n    path: <path d=\"M962.45802178 147.10869599c0-22.5-8.80434756-43.04347823-24.45652178-58.69565244l-1.95652178-1.95652177C903.76236933 54.17391289 851.91454355 54.17391289 819.63193467 85.47826045L342.24063067 528.63043467c-64.56521778-13.69565244-134.02173955 3.91304356-182.93478311 53.80434755C91.80584756 648.95652177 92.78410888 723.30434756 93.76236933 768.30434756v16.63043467c-0.97826045 36.19565244-19.56521777 80.21739112-27.391304 94.89130488-4.89130401 9.78260888-5.86956533 21.52173955-1.95652177 31.30434756 3.91304356 10.76086933 11.73913066 18.58695644 21.52173867 22.5 45.97826045 19.56521777 91.95652177 28.36956533 135.97826132 28.36956533 77.28260888 0 150.65217422-29.34782578 206.41304356-85.10869599 45.97826045-45.97826045 71.41304355-101.73913067 71.41304355-157.5 0-13.69565244-1.95652177-26.41304356-3.91304355-39.13043467l442.17391289-475.43478223C953.65367422 189.17391289 962.45802178 168.63043467 962.45802178 147.10869599zM373.54497822 821.13043467c-57.71739112 57.71739112-136.95652177 76.30434756-220.108696 52.8260871 8.80434756-24.45652178 17.60869599-56.73913067 18.58695733-88.04347821v-19.56521778c-0.97826045-40.10869599-1.95652177-85.10869599 42.0652169-128.15217334 46.95652177-46.95652177 124.23913067-46.95652177 172.17391288 0 23.47826045 23.47826045 36.19565244 51.84782578 36.19565245 81.19565157 0 34.23913067-17.60869599 70.43478222-48.91304355 101.73913066zM883.21889112 150.04347823l-0.97826045 0.97826132-421.63043468 452.93478222c-5.86956533-7.82608711-11.73913066-14.67391289-18.58695644-21.52173955-6.84782578-6.84782578-14.67391289-12.71739112-21.52173955-18.58695644L873.43628223 142.21739112l0.97826132-0.97826045c1.95652177-1.95652177 4.89130401-1.95652177 6.84782578 0l1.95652179 1.95652177c0.97826045 1.95652177 0.97826045 2.93478223 0.97826132 3.91304355 0 0.97826045 0 1.95652177-0.97826132 2.93478223z\"></path>\n  },\n  triangle: {\n    path: <path d=\"M908 915.2H116c-16.08 0-30.79999969-8.80000031-38.08000031-22.00000031a46.75999969 46.75999969 0 0 1 0-43.99999969l396-686.4c7.32-13.2 22.00000031-22.00000031 38.12000062-22.00000031 16.12000031 0 30.79999969 8.80000031 38.11999969 22.00000031l396 686.4c7.36000031 13.2 7.36000031 30.79999969 0 43.99999969-7.32 13.2-22.00000031 22.00000031-38.11999969 22.00000031z m-715.68-88.00000031h639.43999969L512.04000031 272.79999969 192.32 827.19999969z\"></path>\n  },\n  circle: {\n    path: <path d=\"M512 951.99999969C267.99999969 951.99999969 72.00000031 756.00000031 72.00000031 512S267.99999969 72.00000031 512 72.00000031s439.99999969 196.00000031 439.99999969 439.99999969-196.00000031 439.99999969-439.99999969 439.99999969z m0-799.99999969c-199.99999969 0-360 160.00000031-360 360s160.00000031 360 360 360 360-160.00000031 360-360-160.00000031-360-360-360z\"></path>\n  },\n  rect: {\n    path: <path d=\"M164.25714312 881.84h695.48571376c83.98285688 0 126.17142844-41.77714313 126.17142843-124.54285687V266.68571469c0-82.76571469-42.18857156-124.54285687-126.17142843-124.54285781H164.25714312C80.68571469 142.16 38.08571469 183.54285687 38.08571469 266.68571469V757.31428531c0 83.16 42.6 124.54285687 126.17142844 124.54285781z m1.2-64.68c-40.18285687 0-62.67428531-21.29142844-62.67428625-63.08571469V269.94285688c0-41.79428531 22.49142844-63.08571469 62.67428625-63.08571375h693.08571375c39.77142844 0 62.67428531 21.29142844 62.67428625 63.08571375V754.05714312c0 41.79428531-22.90285688 63.08571469-62.67428625 63.08571375z\"></path>\n  },\n  line: {\n    path: <path d=\"M926.293333 97.70666634a42.666667 42.666667 0 0 0-60.586666 0l-768 768a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586666 0l768-768a42.666667 42.666667 0 0 0 0-60.586667z\"></path>\n  },\n  arc: {\n    path: <path d=\"M868.16112577 267.29291265C868.16112577 230.97127564 868.16112577 194.73801245 868.16112577 158.50474924 477.72562135 158.50474924 161.17062436 475.05974625 161.17062436 865.49525063c57.26623061 0 77.59220753 0 108.78816339 0C269.95878775 535.06556506 537.73144017 267.29291265 868.16112577 267.29291265z\"></path>\n  }\n};\n\nfunction FigureSelector() {\n  const newAction = useDispatch();\n  const { drawingStyle, activeSelector } = useSelector((state) => state);\n  const { type } = drawingStyle;\n\n  function handleClick({ target }) {\n    const { dataset } = target;\n    if (dataset.type === type || !dataset.type) return;\n    newAction({\n      type: \"SET_DRAWING_STYLE\",\n      style: { ...drawingStyle, type: dataset.type },\n    });\n  }\n\n  function toggleSelector() {\n    newAction({\n      type: \"SET_ACTIVE_SELECTOR\",\n      activeSelector: activeSelector === 'figure-selector' ? '' : 'figure-selector'\n    });\n  }\n\n  return (\n    <div className={activeSelector === 'figure-selector' ? \"tool-bar-group active-group\" : \"tool-bar-group\"}\n      onClick={toggleSelector}>\n      <svg\n        viewBox=\"0 0 1024 1024\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        className=\"tool-bar-item\"\n      >{shapes[type].path}</svg>\n      <div\n        className=\"tool-bar-popover figure-selector\"\n        onClick={handleClick}\n      >\n        {Object.entries(shapes).map(([key, value]) =>\n          <svg\n            key={key}\n            viewBox=\"0 0 1024 1024\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            data-type={key}\n            className=\"tool-bar-item\"\n          >{value.path}</svg>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default FigureSelector;\n","import \"./index.css\";\nimport React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nfunction PropsSelector() {\n  const newAction = useDispatch();\n  const { drawingStyle, activeSelector } = useSelector((state) => state);\n\n  function handleOnchange({ target }) {\n    drawingStyle.width = Number(target.value);\n    newAction({ type: \"SET_DRAWING_STYLE\", style: drawingStyle });\n  }\n\n  function handleFill({ target }) {\n    drawingStyle.fill = target.checked ? drawingStyle.color : \"transparent\";\n    newAction({ type: \"SET_DRAWING_STYLE\", style: drawingStyle });\n  }\n\n  function toggleSelector() {\n    newAction({\n      type: \"SET_ACTIVE_SELECTOR\",\n      activeSelector: activeSelector === 'props-selector' ? '' : 'props-selector'\n    });\n  }\n\n  return (\n    <div className={activeSelector === 'props-selector' ? \"tool-bar-group active-group\" : \"tool-bar-group\"}\n      onClick={toggleSelector}>\n      <svg className=\"tool-bar-item\"\n        viewBox=\"0 0 1024 1024\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"28\"\n        height=\"28\"\n      >\n        <path d=\"M834.752 61.12a115.2 115.2 0 0 0-160.128 28.288L495.232 345.536l-138.24-96.768a63.104 63.104 0 0 0-86.272 13.44l-0.256 0.384L63.616 548.992a63.104 63.104 0 0 0 13.824 90.048l473.344 331.392a63.232 63.232 0 0 0 89.344-17.728l198.08-291.84 0.576-0.96a63.104 63.104 0 0 0-16.896-85.568l-138.24-96.832 179.328-256.192a115.072 115.072 0 0 0-28.16-160.192zM586.944 917.12l-0.192 0.32-131.008-91.712 83.008-118.592a16 16 0 0 0-3.904-22.272l-19.712-13.76a16 16 0 0 0-22.336 3.904L409.856 793.6 291.84 711.04l82.944-118.528a16 16 0 0 0-3.84-22.272l-19.712-13.824a16 16 0 0 0-22.208 3.968l-83.008 118.528-131.008-91.712 129.792-179.84 466.432 326.72-124.224 183.04z m155.712-229.504L277.632 361.984l43.52-60.16 463.232 324.352-41.728 61.44z m71.168-500.736L634.496 443.072l-90.112-63.04 179.392-256.256a55.04 55.04 0 1 1 90.112 63.104h-0.064z\"></path>\n      </svg>\n      <div className=\"tool-bar-popover props-selector\">\n        <div>\n          <span className='tool-bar-text'>墨迹粗细：</span>\n          <input\n            value={drawingStyle.width}\n            id=\"range\"\n            onChange={handleOnchange}\n            type=\"range\"\n            max={20}\n            min={1}\n          />\n        </div>\n        <div className=\"input-fill\">\n          <span className='tool-bar-text'>填充内部：</span>\n          <input id=\"checkbox\" type=\"checkbox\" onChange={handleFill} />\n          <label htmlFor=\"checkbox\" className=\"input-emoji\">\n            <span className=\"input-tips\">no </span>\n            <span className=\"input-tips\"> off</span>\n            {/*<span className='emoji'>😄</span>*/}\n          </label>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default PropsSelector;\n","function FiguresBak() {\n  this.recoveryStack = [];\n  this.cancelStack = [[]];\n  this.clearFlag = false;\n}\n\nFiguresBak.prototype.addStatus = function (figures) {\n  this.clearFlag = false;\n  this.recoveryStack = [];\n  this.cancelStack.push([...figures]);\n};\n\nFiguresBak.prototype.backStatus = function () {\n  if (!this.clearFlag) {\n    const tmp = this.cancelStack.pop();\n    if (tmp) this.recoveryStack.push(tmp);\n  } else {\n    this.clearFlag = false;\n  }\n  const { length } = this.cancelStack;\n  if (length) return this.cancelStack[length - 1];\n  return null;\n};\nFiguresBak.prototype.recStatus = function () {\n  const tmp = this.recoveryStack.pop();\n  if (tmp) this.cancelStack.push(tmp);\n  return tmp;\n};\n\nFiguresBak.prototype.clearAllStack = function () {\n  if(this.clearFlag) return;\n  this.clearFlag = true;\n};\n\nconst Figures = new FiguresBak();\n\nexport default Figures;\n","import \"./index.css\";\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Figures from \"../../utils/figuresOperateUtil\";\n\nfunction FiguresOperate() {\n  const newAction = useDispatch();\n  const [cancel, setCancel] = useState(true);\n  const [recover, setRecover] = useState(false);\n  const state = useSelector((state) => state);\n\n  function handleCancel() {\n    if (!cancel) return;\n    newAction({ type: \"BACK_TO\" });\n  }\n  function handleRecover() {\n    if (!recover) return;\n    newAction({ type: \"RECOVER_TO\" });\n  }\n  function handleClear() {\n    if (!cancel) return;\n    newAction({ type: \"CLEAR_FIGURES\" });\n  }\n  useEffect(\n    function () {\n      if (Figures.cancelStack.length > 1) setCancel(true);\n      else setCancel(false);\n      if (Figures.recoveryStack.length) setRecover(true);\n      else setRecover(false);\n    },\n    [state]\n  );\n  return (\n    <div className=\"tool-bar-group tool-operate\">\n      <svg\n        className=\"tool-bar-item\"\n        viewBox=\"0 0 1024 1024\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"28\"\n        height=\"28\"\n        data-active={cancel}\n        onClick={handleCancel}\n      >\n        <path d=\"M76 463.7l294.8 294.9c19.5 19.4 52.8 5.6 52.8-21.9V561.5c202.5-8.2 344.1 59.5 501.6 338.3 8.5 15 31.5 7.9 30.6-9.3-30.5-554.7-453-571.4-532.3-569.6v-174c0-27.5-33.2-41.3-52.7-21.8L75.9 420c-12 12.1-12 31.6 0.1 43.7z\"></path>\n      </svg>\n\n      <svg\n        className=\"tool-bar-item\"\n        viewBox=\"0 0 1024 1024\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"28\"\n        height=\"28\"\n        data-active={recover}\n        onClick={handleRecover}\n      >\n        <path d=\"M946.8 420L651.9 125.1c-19.5-19.5-52.7-5.7-52.7 21.8v174c-79.3-1.8-501.8 14.9-532.3 569.6-0.9 17.2 22.1 24.3 30.6 9.3C255 621 396.6 553.3 599.1 561.5v175.2c0 27.5 33.3 41.3 52.8 21.9l294.8-294.9c12.1-12.1 12.1-31.6 0.1-43.7z\"></path>\n      </svg>\n      <svg className=\"tool-bar-item\"\n        viewBox=\"0 0 1024 1024\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"28\"\n        height=\"28\"\n        data-active={!!state.figures?.length}\n        onClick={handleClear}\n      >\n        <path d=\"M298.666667 109.25l426.666667 0 0 85.333333-426.666667 1e-8 0-85.33333301Z\"></path>\n        <path d=\"M896 237.25000001l-85.333333 0-85.333333 0L298.666667 237.25000001 213.333333 237.25000001 128 237.25000001l0 85.33333299 85.333333 0 0 597.333333 597.333333 0L810.666667 322.583333l85.333333 0L896 237.25000001zM725.333333 834.583333L298.666667 834.583333 298.666667 322.583333l426.666667 0L725.333333 834.583333z\" p-id=\"1153\"></path><path d=\"M384 406.666667l85.333333 0 0 341.33333301-85.333333 0 0-341.33333301Z\"></path>\n        <path d=\"M554.666667 406.666667l85.333333 0 0 341.33333301-85.333333 0 0-341.33333301Z\"></path>\n      </svg>\n    </div>\n  );\n}\n\nexport default FiguresOperate;\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nconst handlerModePaths = {\n    \"draw\": <path d=\"M402.77333333 2.27555555c-59.89262222 0-109.22666667 49.33404445-109.22666666 109.22666667v430.09820445l-23.88423112-25.04931556-9.10222222-7.97354666a108.06158222 108.06158222 0 0 0-152.48042666 0 108.06158222 108.06158222 0 0 0 0 152.48042666v1.12867556l298.11598222 294.69354666 2.25735111 1.12867556 1.12867555 2.29376a302.44864 302.44864 0 0 0 182.04444445 61.42179556h62.62328889a297.46062222 297.46062222 0 0 0 298.07957333-298.11598223V439.18222222c0-59.89262222-49.37045333-109.22666667-109.22666667-109.22666667-15.51018667 0-29.85528889 4.25984-43.25376 10.23089778C787.90656 292.85489778 744.83484445 257.13777778 694.04444445 257.13777778c-27.88920889 0-53.48465778 10.92266667-72.81777778 28.43534222A108.64412445 108.64412445 0 0 0 548.40888889 257.13777778a107.40622222 107.40622222 0 0 0-36.40888889 6.84487111V111.50222222c0-59.89262222-49.33404445-109.22666667-109.22666667-109.22666667z m0 72.81777778c20.20693333 0 36.40888889 16.20195555 36.40888889 36.40888889v400.49777778h72.81777778v-145.63555555c0-20.20693333 16.20195555-36.40888889 36.40888889-36.4088889 20.20693333 0 36.40888889 16.20195555 36.40888889 36.4088889v145.63555555h72.81777777v-145.63555555c0-20.20693333 16.20195555-36.40888889 36.4088889-36.4088889 20.20693333 0 36.40888889 16.20195555 36.40888888 36.4088889v145.63555555h76.24021334v-72.81777778c0-20.20693333 16.20195555-36.40888889 36.40888888-36.40888889 20.17052445 0 36.40888889 16.20195555 36.4088889 36.40888889v284.46264889c0 126.12039111-99.14140445 225.26179555-225.29820445 225.26179556h-62.55047111c-53.33902222 0-99.43267555-19.04184889-137.69841778-47.80487112l-294.69354666-291.2711111c-16.20195555-16.20195555-16.20195555-33.86026667 0-50.06222223 16.23836445-16.20195555 33.86026667-16.20195555 50.06222222 0L366.36444445 716.8V111.50222222c0-20.20693333 16.20195555-36.40888889 36.40888888-36.40888889z\"></path>,\n    \"handler\": <path d=\"M371.35894623 933.82683868a35.15424307 35.15424307 0 0 1-33.04498837-24.6079704l-246.07970317-773.3933517A35.15424307 35.15424307 0 0 1 100.67127268 100.67127268a35.15424307 35.15424307 0 0 1 35.1542439-8.43701798l773.3933517 246.07970316A35.15424307 35.15424307 0 0 1 933.82683868 371.35894623a35.15424307 35.15424307 0 0 1-23.90488522 35.15424308l-262.60219775 87.53406591 241.1581094 240.80656641a35.15424307 35.15424307 0 0 1 0 49.91902596l-105.46273003 105.46272922a35.15424307 35.15424307 0 0 1-49.91902516 0l-240.8065664-241.15810857L406.51318931 909.92195346A35.15424307 35.15424307 0 0 1 371.35894623 933.82683868z m105.46273004-386.69667626a35.15424307 35.15424307 0 0 1 24.95951258 10.19473049l256.27443364 256.62597583L813.95086874 758.0556225l-256.62597583-256.27443365a35.15424307 35.15424307 0 0 1-9.14010315-33.04498838 35.15424307 35.15424307 0 0 1 22.8502587-25.31105557l214.08934131-70.30848614L179.41677762 179.41677762 371.35894623 785.12438977l70.30848697-214.08934131a35.15424307 35.15424307 0 0 1 25.31105475-22.8502587A31.99036103 31.99036103 0 0 1 476.82167627 547.13016241z\"></path>\n}\n\nfunction HandlerMode() {\n    const newAction = useDispatch();\n    const { handlerMode = 'draw' } = useSelector((state) => state);\n    const changeHandlerMode = () => newAction({\n        type: \"CHANGE_HANDLER_MODE\",\n        handlerMode: handlerMode === 'handler' ? 'draw' : 'handler'\n    });\n    return (\n        <div className=\"tool-bar-group\" onClick={changeHandlerMode}>\n            <svg key={handlerMode} className=\"tool-bar-item\" viewBox=\"0 0 1024 1024\"\n                xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\">\n                {handlerModePaths[handlerMode]}\n            </svg>\n        </div>\n    );\n}\n\nexport default HandlerMode;\n","import \"./index.css\";\nimport React, { useRef } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport ColorSelector from \"../colorSelector\";\nimport FigureSelector, { shapes } from \"../figureSelector\";\nimport PropsSelector from \"../propsSelector\";\nimport FiguresOperate from \"../figuresOperate\";\nimport HandlerMode from \"../handlerMode\";\nimport { useState } from \"react\";\n\n\nlet onTouch = false,\n  onMove = false,\n  lastX = null,\n  lastY = null;\n\nfunction ToolBar() {\n  const wrapRef = useRef();\n  const [transform, setTransform] = useState({ transX: 0, transY: 0 });\n  const { transX, transY } = transform;\n  const { innerWidth: width, innerHeight: height } = window;\n  const { drawingStyle } = useSelector((state) => state);\n\n  function handleWheel(e) {\n    const { current } = wrapRef;\n    e.stopPropagation();\n    current.scrollTo({\n      left: ~~(current.scrollLeft + e.deltaY * 0.5)\n    });\n  }\n\n  function handleMouseDown(e) {\n    onMove = true;\n    const { nativeEvent } = e;\n    lastX = nativeEvent.offsetX;\n    lastY = nativeEvent.offsetY;\n  }\n\n  function handleMouseMove(e) {\n    if (!onMove) return;\n    const { nativeEvent } = e;\n    const { offsetX, offsetY } = nativeEvent;\n    const newTransX = transX + offsetX - lastX;\n    const newTransY = transY + offsetY - lastY;\n    const newTransform = { transX: newTransX, transY: newTransY };\n    lastX = offsetX;\n    lastY = offsetY;\n    setTransform(newTransform);\n  }\n\n\n  function touchToMouse(e) {\n    const {\n      touches: [{ pageX, pageY }],\n    } = e;\n    const offsetX = pageX;\n    const offsetY = pageY;\n    return { nativeEvent: { offsetX, offsetY } };\n  }\n\n  function handleTouchEnd() {\n    onTouch = false;\n    onMove = false;\n    const deltaX = Math.abs(transX);\n    const deltaY = Math.abs(transY);\n    const x = deltaX > width / 12 ? deltaX / transX * (width / 2 - 50) : 0;\n    const y = deltaY > height / 2 ? -height + 100 : 0;\n    setTransform({ transX: x, transY: y });\n  }\n\n  function handleTouchMove(e) {\n    if(e.target.tagName === 'input') return;\n    if (onTouch) {\n      handleMouseMove(touchToMouse(e));\n    } else {\n      onTouch = true;\n      handleMouseDown(touchToMouse(e));\n    }\n  }\n\n  function handleIndicatorClick() {\n    setTransform({ ...transform, transX: 0 });\n  }\n\n  return (\n    <div className=\"tool-bar-wrap\"\n      style={{ \"--fillColor\": drawingStyle.color }}\n      onWheel={handleWheel}\n      ref={wrapRef}\n    >\n      <div className={`tool-bar ${Math.abs(transX) > width / 12 ? 'collapsed' : ''} ${Math.abs(transY) > height / 2 ? 'tool-bar-up' : ''}`}\n        onTouchEnd={handleTouchEnd}\n        onTouchMove={handleTouchMove}\n        style={{\n          transform: 'translate(' + transX + 'px, ' + transY + 'px)',\n          transition: onTouch ? \"width .2s\" : \"transform .3s,width .2s\",\n          width: Math.abs(transX) > width / 12 ? '50px' : '350px'\n        }}>\n        <HandlerMode />\n        <ColorSelector />\n        <FigureSelector />\n        <PropsSelector />\n        <FiguresOperate />\n        <svg\n          viewBox=\"0 0 1024 1024\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"tool-bar-item collapsed-indicator\"\n          onClick={handleIndicatorClick}\n        >{shapes[drawingStyle.type].path}</svg>\n      </div>\n    </div>\n  );\n}\n\nexport default ToolBar;\n","import React, { Fragment } from \"react\";\nimport DrawingBox from \"./components/drawingBox\";\nimport ToolBar from \"./components/controlsBar\";\n\nfunction App() {\n  return (\n    <Fragment>\n      <DrawingBox />\n      <ToolBar />\n    </Fragment>\n  );\n}\n\nexport default App;\n","import { createStore } from \"redux\";\nimport Figures from \"./figuresOperateUtil\";\n\nconst configKey = 'drawingBoard:drawingStyle';\n\nconst defaultState = {\n  figures: [],\n  drawingStyle: localStorage.getItem(configKey) ? JSON.parse(localStorage.getItem(configKey)) : {\n    type: \"path\",\n    color: \"orange\",\n    width: 2,\n    fill: \"transparent\",\n  }\n};\n\nfunction handleAction(state = defaultState, action) {\n  const {\n    type\n  } = action;\n  if (type === \"INIT_FIGURES\") {\n    action.figures.forEach(f => state.figures.push(f));\n    Figures.addStatus(state.figures);\n    return {\n      ...state\n    };\n  } else if (type === \"ADD_NEW_FIGURE\") {\n    state.figures.push(action.figure);\n    Figures.addStatus(state.figures);\n    return {\n      ...state\n    };\n  } else if (type === \"SET_DRAWING_STYLE\") {\n    state.drawingStyle = action.style;\n    localStorage.setItem(configKey, JSON.stringify(state.drawingStyle));\n    return {\n      ...state\n    };\n  } else if (type === \"SET_ACTIVE_SELECTOR\") {\n    state.activeSelector = action.activeSelector;\n    return {\n      ...state\n    };\n  } else if (type === \"CHANGE_HANDLER_MODE\") {\n    state.handlerMode = action.handlerMode;\n    return {\n      ...state\n    };\n  } else if (type === \"CLEAR_FIGURES\") {\n    Figures.clearAllStack();\n    state.figures = [];\n    return {\n      ...state\n    };\n  } else if (type === \"BACK_TO\") {\n    const lastStatus = Figures.backStatus();\n    if (lastStatus) {\n      state.figures = [...lastStatus];\n      return {\n        ...state\n      };\n    }\n  } else if (type === \"RECOVER_TO\") {\n    const lastStatus = Figures.recStatus();\n    if (lastStatus) {\n      state.figures = [...lastStatus];\n      return {\n        ...state\n      };\n    }\n  }\n  return state;\n}\n\nconst store = createStore(handleAction);\nexport default store;","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport store from \"./utils/reduxUtil\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { Provider } from \"react-redux\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"drawing-board\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}