(this["webpackJsonpsvg-drawing-board"]=this["webpackJsonpsvg-drawing-board"]||[]).push([[0],[,,,,,,,,,,,,,function(t,e,n){},,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var o=n(1),c=n(6),r=n(3),a=(n(13),n(2)),s=n(0);function i(t,e){const{nativeEvent:n}=t;e.moveX=n.offsetX,e.moveY=n.offsetY}function l(t,e){const{downX:n,downY:o,moveX:c,moveY:r,color:a,width:i,fill:l}=t;if(c)return Object(s.jsx)("line",{x1:n,x2:c,y1:o,y2:r,stroke:a,fill:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i},e)}function u(t,e){const{nativeEvent:n}=t;e.path+="L".concat(n.offsetX," ").concat(n.offsetY)}function d(t,e){const{path:n,color:o,width:c,downX:r,downY:a}=t;if(!n)return null;const i="M".concat(r," ").concat(a," ")+n;return Object(s.jsx)("path",{stroke:o,strokeWidth:c,fill:"transparent",strokeLinecap:"round",strokeLinejoin:"round",d:i},e)}function f(t,e){const{nativeEvent:n}=t;e.moveX=n.offsetX,e.moveY=n.offsetY}function h(t,e){const{color:n,fill:o,width:c}=t;let{downX:r,downY:a,moveX:i,moveY:l}=t;if(!i)return;let u=i-r,d=l-a;return u<0&&(r+=u,u=-u),d<0&&(a+=d,d=-d),Object(s.jsx)("rect",{x:r,y:a,width:u,height:d,stroke:n,fill:o,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:c},e)}function p(t,e){const{nativeEvent:n}=t,{downX:o,downY:c}=e;e.cx=(o+n.offsetX)/2,e.cy=(c+n.offsetY)/2,e.r=Math.max(Math.abs(n.offsetX-o),Math.abs(n.offsetY-c))/2}function b(t,e){const{cx:n,cy:o,r:c,color:r,fill:a,width:i}=t;return Object(s.jsx)("circle",{r:c,cx:n,cy:o,stroke:r,fill:a,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i},e)}function j(t,e){const{nativeEvent:n}=t;e.moveX=n.offsetX,e.moveY=n.offsetY}function g(t,e){const{downX:n,downY:o,moveX:c,moveY:r,color:a,width:i,fill:l}=t;if(!c)return;const u="".concat((n+c)/2," ").concat(o,",").concat(n," ").concat(r,",").concat(c," ").concat(r);return Object(s.jsx)("polygon",{stroke:a,points:u,fill:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i},e)}function w(t,e){const{nativeEvent:n}=t;e.path=" Q ".concat(n.offsetX," ").concat(e.downY," ").concat(n.offsetX," ").concat(n.offsetY)}function v(t,e){const{color:n,width:o,downX:c,downY:r,path:a}=t,i="M".concat(c," ").concat(r," ")+a;return Object(s.jsx)("path",{stroke:n,strokeWidth:o,fill:"transparent",strokeLinecap:"round",strokeLinejoin:"round",d:i},e)}var O=n(10);var m=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:8};const n=Object(O.a)(t,e);if(!n.length)return"";const o=n.reduce((t,e,n,o)=>{let[c,r]=e;const[a,s]=o[(n+1)%o.length];return t.push(c,r,(c+a)/2,(r+s)/2),t},["M",...n[0],"Q"]);return o.push("Z"),o.join(" ")};let x;function S(t,e){const{path:n,width:o,downX:c,downY:r}=e,{nativeEvent:a}=t;n||(x=[[c,r]]),x.push([a.offsetX,a.offsetY]),e.path=m(x,{size:o,thinning:.5,smoothing:.5,streamline:.5,start:{taper:1},end:{taper:1}})}var E=function(t,e){const{type:n}=t;if("empty"===n)return null;let o=function(){};if("path"===n)o=d;else if("freeHand"===n)o=d;else if("line"===n)o=l;else if("rect"===n)o=h;else if("circle"===n)o=b;else if("triangle"===n)o=g;else{if("arc"!==n)return null;o=v}return o(t,e)};var y=t=>{const e=Object(o.useRef)(t);Object(o.useEffect)(()=>{const t=e.current;return window.addEventListener("unload",t),()=>{window.removeEventListener("unload",t)}},[e])};function k(t){let{target:{result:e}}=t;const{id:n,data:o,onsuccess:c,onerror:r}=this.callback,a=e.transaction("figures","readwrite").objectStore("figures").add({id:n,data:o});a.onerror=r,a.onsuccess=c}function M(t){let{target:{result:e}}=t;console.info("\u5c1d\u8bd5\u521b\u5efa\u6570\u636e\u5e93"),e.objectStoreNames.contains("figures")||e.createObjectStore("figures",{keyPath:"id"})}function L(){console.error("\u6570\u636e\u5e93\u8fde\u63a5\u5931\u8d25"),this.callback.onerror()}var N=function(t,e,n,o){const c=indexedDB.open("drawing-board",3);c.callback={id:t,data:e,onsuccess:n,onerror:o},c.onsuccess=k,c.onerror=L,c.onupgradeneeded=M};function Y(t){let{target:{result:e}}=t;const{id:n,onsuccess:o,onerror:c}=this.callback,r=e.transaction("figures").objectStore("figures").get(n);r.onerror=c,r.onsuccess=function(t){t.target.result&&o(t.target.result)}}function X(){console.error("\u6570\u636e\u5e93\u8fde\u63a5\u5931\u8d25"),this.callback.onerror()}function C(t){let{target:{result:e}}=t;console.info("\u5c1d\u8bd5\u521b\u5efa\u6570\u636e\u5e93"),e.objectStoreNames.contains("figures")||e.createObjectStore("figures",{keyPath:"id"})}var T=function(t,e,n){const o=indexedDB.open("drawing-board",3);o.callback={id:t,onsuccess:e,onerror:n},o.onsuccess=Y,o.onerror=X,o.onupgradeneeded=C};function _(t){let{target:{result:e}}=t;const{id:n,onsuccess:o,onerror:c}=this.callback,r=e.transaction("figures","readwrite").objectStore("figures").delete(n);r.onerror=c,r.onsuccess=o}function A(){console.error("\u6570\u636e\u5e93\u8fde\u63a5\u5931\u8d25"),this.callback.onerror()}var z=function(t,e,n){const o=indexedDB.open("drawing-board",3);o.callback={id:t,onsuccess:e,onerror:n},o.onsuccess=_,o.onerror=A};let I=!1,R=!1,D=!1,F=!1,B=null,W=null,H=!1,V=0,G=0,U=0,J=null;var P=function(){const t=Object(a.b)(),[e,n]=Object(o.useState)({}),{drawingStyle:c,activeSelector:l,handlerMode:d}=Object(a.c)(t=>t),{figures:h}=Object(a.c)(t=>t);function b(t){R=!0;const{nativeEvent:n}=t,{color:o,width:r,fill:a}=c;e.color=o,e.width=r,e.fill=a,e.path="",e.type=c.type,e.key=Date.now(),e.downX=n.offsetX,e.downY=n.offsetY}function g(){F=!0,n(Object(r.a)({},e))}function v(n){if(""!==l&&t({type:"SET_ACTIVE_SELECTOR",activeSelector:""}),!R)return;e.flag=!0;let o=function(){};const{type:r}=c;"path"===r?o=u:"freeHand"===r?o=S:"line"===r?o=i:"rect"===r?o=f:"circle"===r?o=p:"triangle"===r?o=j:"arc"===r&&(o=w),o(n,e),D||(D=!0,requestAnimationFrame(g))}function O(){if(I)return;if(R=!1,null===e||void 0===e||!e.flag)return;const n=Object(r.a)({end:!0},e);e.type="",t({type:"ADD_NEW_FIGURE",figure:n})}function m(t){const{target:e,touches:[{pageX:n,pageY:o}]}=t,c=["path","circle","line","rect","polygon"].includes(e.tagName)?e.parentElement.parentElement:e.parentElement;return{nativeEvent:{offsetX:n-c.offsetLeft,offsetY:o-c.offsetTop}}}return B=h,y(function(){localStorage.setItem("lastDrawingBoard",JSON.stringify({id:location.pathname,figures:B}))}),Object(o.useEffect)(()=>{const e=localStorage.getItem("lastDrawingBoard");if(e){const{id:n,figures:o}=JSON.parse(e);if(n===location.pathname)return void t({type:"INIT_FIGURES",figures:o});z(n,()=>N(n,o))}T(location.pathname,e=>{let{data:n}=e;n&&t({type:"INIT_FIGURES",figures:n})})},[]),Object(o.useEffect)(function(){F&&(D=!1,F=!1)},[e]),Object(o.useEffect)(function(){return()=>{J&&(cancelAnimationFrame(J),J=null)}},[]),Object(s.jsxs)(o.Fragment,{children:[Object(s.jsxs)("svg",{className:"drawing-box",onTouchEnd:function(t){if(H&&(t.preventDefault(),H=!1,function(){const t=50;if(Math.abs(V)<t&&Math.abs(G)<t)return V=0,void(G=0);const e=.95,n=.5;function o(){V*=e,G*=e;const c=V/60,r=G/60;if(Math.abs(V)<t&&Math.abs(G)<t)return V=0,G=0,void(J=null);const a=document.documentElement.scrollWidth-window.innerWidth,s=document.documentElement.scrollHeight-window.innerHeight;let i=c,l=r;window.scrollX+c<0?(i=-window.scrollX,V=0):window.scrollX+c>a&&(i=a-window.scrollX,V=0),window.scrollY+r<0?(l=-window.scrollY,G=0):window.scrollY+r>s&&(l=s-window.scrollY,G=0),(Math.abs(i)>n||Math.abs(l)>n)&&scrollBy({left:i,top:l,behavior:"auto"}),J=requestAnimationFrame(o)}J=requestAnimationFrame(o)}()),W=null,!R)return!0;t.preventDefault(),I=!1,O()},onTouchMove:function(t){if(2===t.touches.length)return t.preventDefault(),H||(H=!0,R&&(R=!1,I=!1,e.type="",n({})),J&&(cancelAnimationFrame(J),J=null)),void function(t){let[{identifier:e,pageX:n,pageY:o},{identifier:c,pageX:r,pageY:a}]=t;const s=Date.now();if(W&&W[e]&&W[c]){const[t,i]=W[e],[l,u]=W[c];let d=(t-n+(l-r))/2,f=(i-o+(u-a))/2;const h=document.documentElement.scrollWidth-window.innerWidth,p=document.documentElement.scrollHeight-window.innerHeight;window.scrollX+d<0?d=-window.scrollX:window.scrollX+d>h&&(d=h-window.scrollX),window.scrollY+f<0?f=-window.scrollY:window.scrollY+f>p&&(f=p-window.scrollY),(Math.abs(d)>.5||Math.abs(f)>.5)&&scrollBy({left:d,top:f,behavior:"auto"});const b=s-U;if(b>0){const t=.3;V=t*(d/b)*1e3+(1-t)*V,G=t*(f/b)*1e3+(1-t)*G}}W={[e]:[n,o],[c]:[r,a]},U=s}(t.touches);H||(I?v(m(t)):(I=!0,b(m(t))))},onMouseUp:O,onMouseDown:b,onMouseMove:v,onMouseLeave:function(){R=!1},children:[h.map((t,e)=>E(t,e)),E(e)]}),"handler"===d?Object(s.jsx)("div",{className:"drawing-mask"}):null]})};n(17);const Z=["#ff776d","#020826","#8c7851","#008eff","orange"];var q=function(){const t=Object(a.b)(),{drawingStyle:e,activeSelector:n}=Object(a.c)(t=>t);return Object(s.jsxs)("div",{className:"color-selector"===n?"tool-bar-group active-group":"tool-bar-group",onClick:function(){t({type:"SET_ACTIVE_SELECTOR",activeSelector:"color-selector"===n?"":"color-selector"})},children:[Object(s.jsxs)("svg",{className:"tool-bar-item",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",children:[Object(s.jsx)("path",{d:"M852.456667 216.746667A452.693333 452.693333 0 0 0 526.90999999 85.333333a426.666667 426.666667 0 0 0-2.133333 853.333334 110.08 110.08 0 0 0 107.946666-80.64 107.52 107.52 0 0 0-24.31999999-97.28 21.333333 21.333333 0 0 1 15.786667-35.413334h70.39999999A262.4 262.4 0 0 0 957.41666699 483.413333a361.813333 361.813333 0 0 0-104.96-266.666666zM696.296667 640h-70.4a106.24 106.24 0 0 0-79.786667 177.066667 20.906667 20.906667 0 0 1 5.12 20.906666c-2.133333 8.96-11.946667 14.506667-25.173333 15.36a341.333333 341.333333 0 0 1-333.653334-388.693333A345.6 345.6 0 0 1 527.336667 170.666667H530.75a361.386667 361.386667 0 0 1 260.266667 105.813333 277.333333 277.333333 0 0 1 81.066666 203.52A177.92 177.92 0 0 1 696.296667 640z","p-id":"996"}),Object(s.jsx)("path",{d:"M530.75 277.333333m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"997"}),Object(s.jsx)("path",{d:"M669.41666699 307.2a64 64 0 1 0 87.46666601 23.466667 64 64 0 0 0-87.46666601-23.466667zM392.083333 307.2a64 64 0 1 0 23.466667 87.466667 64 64 0 0 0-23.466667-87.466667zM281.576667 480.426667a64 64 0 1 0 88.746666 17.066666 63.573333 63.573333 0 0 0-88.746666-17.066666z"})]}),Object(s.jsx)("div",{className:"tool-bar-popover",onClick:function(n){let{target:o}=n;const{dataset:c}=o;c.color&&(e.color=c.color,"transparent"!==e.fill&&(e.fill=c.color),t({type:"SET_DRAWING_STYLE",style:e}))},children:Z.map((t,e)=>Object(s.jsx)("span",{className:"tool-bar-item",style:{backgroundColor:t},"data-color":t},e))})]})};n(18);const K={path:{path:Object(s.jsx)("path",{d:"M938.666667 308.906667a42.666667 42.666667 0 0 0-12.373334-30.293334l-180.906666-180.906666a42.666667 42.666667 0 0 0-30.293334-12.373334 42.666667 42.666667 0 0 0-30.293333 12.373334l-120.746667 120.746666L97.706667 684.8a42.666667 42.666667 0 0 0-12.373334 30.293333V896a42.666667 42.666667 0 0 0 42.666667 42.666667h180.906667a42.666667 42.666667 0 0 0 32.426666-12.373334l463.786667-466.346666L926.293333 341.333333a50.773333 50.773333 0 0 0 9.386667-14.08 42.666667 42.666667 0 0 0 0-10.24 29.866667 29.866667 0 0 0 0-5.973333zM291.413333 853.333333H170.666667v-120.746666l423.68-423.68 120.746666 120.746666zM775.253333 369.493333l-120.746666-120.746666 60.586666-60.16 120.32 120.32z"})},freeHand:{path:Object(s.jsx)("path",{d:"M962.45802178 147.10869599c0-22.5-8.80434756-43.04347823-24.45652178-58.69565244l-1.95652178-1.95652177C903.76236933 54.17391289 851.91454355 54.17391289 819.63193467 85.47826045L342.24063067 528.63043467c-64.56521778-13.69565244-134.02173955 3.91304356-182.93478311 53.80434755C91.80584756 648.95652177 92.78410888 723.30434756 93.76236933 768.30434756v16.63043467c-0.97826045 36.19565244-19.56521777 80.21739112-27.391304 94.89130488-4.89130401 9.78260888-5.86956533 21.52173955-1.95652177 31.30434756 3.91304356 10.76086933 11.73913066 18.58695644 21.52173867 22.5 45.97826045 19.56521777 91.95652177 28.36956533 135.97826132 28.36956533 77.28260888 0 150.65217422-29.34782578 206.41304356-85.10869599 45.97826045-45.97826045 71.41304355-101.73913067 71.41304355-157.5 0-13.69565244-1.95652177-26.41304356-3.91304355-39.13043467l442.17391289-475.43478223C953.65367422 189.17391289 962.45802178 168.63043467 962.45802178 147.10869599zM373.54497822 821.13043467c-57.71739112 57.71739112-136.95652177 76.30434756-220.108696 52.8260871 8.80434756-24.45652178 17.60869599-56.73913067 18.58695733-88.04347821v-19.56521778c-0.97826045-40.10869599-1.95652177-85.10869599 42.0652169-128.15217334 46.95652177-46.95652177 124.23913067-46.95652177 172.17391288 0 23.47826045 23.47826045 36.19565244 51.84782578 36.19565245 81.19565157 0 34.23913067-17.60869599 70.43478222-48.91304355 101.73913066zM883.21889112 150.04347823l-0.97826045 0.97826132-421.63043468 452.93478222c-5.86956533-7.82608711-11.73913066-14.67391289-18.58695644-21.52173955-6.84782578-6.84782578-14.67391289-12.71739112-21.52173955-18.58695644L873.43628223 142.21739112l0.97826132-0.97826045c1.95652177-1.95652177 4.89130401-1.95652177 6.84782578 0l1.95652179 1.95652177c0.97826045 1.95652177 0.97826045 2.93478223 0.97826132 3.91304355 0 0.97826045 0 1.95652177-0.97826132 2.93478223z"})},triangle:{path:Object(s.jsx)("path",{d:"M908 915.2H116c-16.08 0-30.79999969-8.80000031-38.08000031-22.00000031a46.75999969 46.75999969 0 0 1 0-43.99999969l396-686.4c7.32-13.2 22.00000031-22.00000031 38.12000062-22.00000031 16.12000031 0 30.79999969 8.80000031 38.11999969 22.00000031l396 686.4c7.36000031 13.2 7.36000031 30.79999969 0 43.99999969-7.32 13.2-22.00000031 22.00000031-38.11999969 22.00000031z m-715.68-88.00000031h639.43999969L512.04000031 272.79999969 192.32 827.19999969z"})},circle:{path:Object(s.jsx)("path",{d:"M512 951.99999969C267.99999969 951.99999969 72.00000031 756.00000031 72.00000031 512S267.99999969 72.00000031 512 72.00000031s439.99999969 196.00000031 439.99999969 439.99999969-196.00000031 439.99999969-439.99999969 439.99999969z m0-799.99999969c-199.99999969 0-360 160.00000031-360 360s160.00000031 360 360 360 360-160.00000031 360-360-160.00000031-360-360-360z"})},rect:{path:Object(s.jsx)("path",{d:"M164.25714312 881.84h695.48571376c83.98285688 0 126.17142844-41.77714313 126.17142843-124.54285687V266.68571469c0-82.76571469-42.18857156-124.54285687-126.17142843-124.54285781H164.25714312C80.68571469 142.16 38.08571469 183.54285687 38.08571469 266.68571469V757.31428531c0 83.16 42.6 124.54285687 126.17142844 124.54285781z m1.2-64.68c-40.18285687 0-62.67428531-21.29142844-62.67428625-63.08571469V269.94285688c0-41.79428531 22.49142844-63.08571469 62.67428625-63.08571375h693.08571375c39.77142844 0 62.67428531 21.29142844 62.67428625 63.08571375V754.05714312c0 41.79428531-22.90285688 63.08571469-62.67428625 63.08571375z"})},line:{path:Object(s.jsx)("path",{d:"M926.293333 97.70666634a42.666667 42.666667 0 0 0-60.586666 0l-768 768a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586666 0l768-768a42.666667 42.666667 0 0 0 0-60.586667z"})},arc:{path:Object(s.jsx)("path",{d:"M868.16112577 267.29291265C868.16112577 230.97127564 868.16112577 194.73801245 868.16112577 158.50474924 477.72562135 158.50474924 161.17062436 475.05974625 161.17062436 865.49525063c57.26623061 0 77.59220753 0 108.78816339 0C269.95878775 535.06556506 537.73144017 267.29291265 868.16112577 267.29291265z"})}};var Q=function(){const t=Object(a.b)(),{drawingStyle:e,activeSelector:n}=Object(a.c)(t=>t),{type:o}=e;return Object(s.jsxs)("div",{className:"figure-selector"===n?"tool-bar-group active-group":"tool-bar-group",onClick:function(){t({type:"SET_ACTIVE_SELECTOR",activeSelector:"figure-selector"===n?"":"figure-selector"})},children:[Object(s.jsx)("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",className:"tool-bar-item",children:K[o].path}),Object(s.jsx)("div",{className:"tool-bar-popover figure-selector",onClick:function(n){let{target:c}=n;const{dataset:a}=c;a.type!==o&&a.type&&t({type:"SET_DRAWING_STYLE",style:Object(r.a)(Object(r.a)({},e),{},{type:a.type})})},children:Object.entries(K).map(t=>{let[e,n]=t;return Object(s.jsx)("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","data-type":e,className:"tool-bar-item",children:n.path},e)})})]})};n(19);var $=function(){const t=Object(a.b)(),{drawingStyle:e,activeSelector:n}=Object(a.c)(t=>t);return Object(s.jsxs)("div",{className:"props-selector"===n?"tool-bar-group active-group":"tool-bar-group",onClick:function(){t({type:"SET_ACTIVE_SELECTOR",activeSelector:"props-selector"===n?"":"props-selector"})},children:[Object(s.jsx)("svg",{className:"tool-bar-item",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",children:Object(s.jsx)("path",{d:"M834.752 61.12a115.2 115.2 0 0 0-160.128 28.288L495.232 345.536l-138.24-96.768a63.104 63.104 0 0 0-86.272 13.44l-0.256 0.384L63.616 548.992a63.104 63.104 0 0 0 13.824 90.048l473.344 331.392a63.232 63.232 0 0 0 89.344-17.728l198.08-291.84 0.576-0.96a63.104 63.104 0 0 0-16.896-85.568l-138.24-96.832 179.328-256.192a115.072 115.072 0 0 0-28.16-160.192zM586.944 917.12l-0.192 0.32-131.008-91.712 83.008-118.592a16 16 0 0 0-3.904-22.272l-19.712-13.76a16 16 0 0 0-22.336 3.904L409.856 793.6 291.84 711.04l82.944-118.528a16 16 0 0 0-3.84-22.272l-19.712-13.824a16 16 0 0 0-22.208 3.968l-83.008 118.528-131.008-91.712 129.792-179.84 466.432 326.72-124.224 183.04z m155.712-229.504L277.632 361.984l43.52-60.16 463.232 324.352-41.728 61.44z m71.168-500.736L634.496 443.072l-90.112-63.04 179.392-256.256a55.04 55.04 0 1 1 90.112 63.104h-0.064z"})}),Object(s.jsxs)("div",{className:"tool-bar-popover props-selector",children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{className:"tool-bar-text",children:"\u58a8\u8ff9\u7c97\u7ec6\uff1a"}),Object(s.jsx)("input",{value:e.width,id:"range",onChange:function(n){let{target:o}=n;e.width=Number(o.value),t({type:"SET_DRAWING_STYLE",style:e})},type:"range",max:20,min:1})]}),Object(s.jsxs)("div",{className:"input-fill",children:[Object(s.jsx)("span",{className:"tool-bar-text",children:"\u586b\u5145\u5185\u90e8\uff1a"}),Object(s.jsx)("input",{id:"checkbox",type:"checkbox",onChange:function(n){let{target:o}=n;e.fill=o.checked?e.color:"transparent",t({type:"SET_DRAWING_STYLE",style:e})}}),Object(s.jsxs)("label",{htmlFor:"checkbox",className:"input-emoji",children:[Object(s.jsx)("span",{className:"input-tips",children:"no "}),Object(s.jsx)("span",{className:"input-tips",children:" off"})]})]})]})]})};n(20);function tt(){this.recoveryStack=[],this.cancelStack=[[]],this.clearFlag=!1}tt.prototype.addStatus=function(t){this.clearFlag=!1,this.recoveryStack=[],this.cancelStack.push([...t])},tt.prototype.backStatus=function(){if(this.clearFlag)this.clearFlag=!1;else{const t=this.cancelStack.pop();t&&this.recoveryStack.push(t)}const{length:t}=this.cancelStack;return t?this.cancelStack[t-1]:null},tt.prototype.recStatus=function(){const t=this.recoveryStack.pop();return t&&this.cancelStack.push(t),t},tt.prototype.clearAllStack=function(){this.clearFlag||(this.clearFlag=!0)};var et=new tt;var nt=function(){var t;const e=Object(a.b)(),[n,c]=Object(o.useState)(!0),[r,i]=Object(o.useState)(!1),l=Object(a.c)(t=>t);return Object(o.useEffect)(function(){et.cancelStack.length>1?c(!0):c(!1),et.recoveryStack.length?i(!0):i(!1)},[l]),Object(s.jsxs)("div",{className:"tool-bar-group tool-operate",children:[Object(s.jsx)("svg",{className:"tool-bar-item",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28","data-active":n,onClick:function(){n&&e({type:"BACK_TO"})},children:Object(s.jsx)("path",{d:"M76 463.7l294.8 294.9c19.5 19.4 52.8 5.6 52.8-21.9V561.5c202.5-8.2 344.1 59.5 501.6 338.3 8.5 15 31.5 7.9 30.6-9.3-30.5-554.7-453-571.4-532.3-569.6v-174c0-27.5-33.2-41.3-52.7-21.8L75.9 420c-12 12.1-12 31.6 0.1 43.7z"})}),Object(s.jsx)("svg",{className:"tool-bar-item",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28","data-active":r,onClick:function(){r&&e({type:"RECOVER_TO"})},children:Object(s.jsx)("path",{d:"M946.8 420L651.9 125.1c-19.5-19.5-52.7-5.7-52.7 21.8v174c-79.3-1.8-501.8 14.9-532.3 569.6-0.9 17.2 22.1 24.3 30.6 9.3C255 621 396.6 553.3 599.1 561.5v175.2c0 27.5 33.3 41.3 52.8 21.9l294.8-294.9c12.1-12.1 12.1-31.6 0.1-43.7z"})}),Object(s.jsxs)("svg",{className:"tool-bar-item",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28","data-active":!(null===(t=l.figures)||void 0===t||!t.length),onClick:function(){n&&e({type:"CLEAR_FIGURES"})},children:[Object(s.jsx)("path",{d:"M298.666667 109.25l426.666667 0 0 85.333333-426.666667 1e-8 0-85.33333301Z"}),Object(s.jsx)("path",{d:"M896 237.25000001l-85.333333 0-85.333333 0L298.666667 237.25000001 213.333333 237.25000001 128 237.25000001l0 85.33333299 85.333333 0 0 597.333333 597.333333 0L810.666667 322.583333l85.333333 0L896 237.25000001zM725.333333 834.583333L298.666667 834.583333 298.666667 322.583333l426.666667 0L725.333333 834.583333z","p-id":"1153"}),Object(s.jsx)("path",{d:"M384 406.666667l85.333333 0 0 341.33333301-85.333333 0 0-341.33333301Z"}),Object(s.jsx)("path",{d:"M554.666667 406.666667l85.333333 0 0 341.33333301-85.333333 0 0-341.33333301Z"})]})]})};const ot={draw:Object(s.jsx)("path",{d:"M402.77333333 2.27555555c-59.89262222 0-109.22666667 49.33404445-109.22666666 109.22666667v430.09820445l-23.88423112-25.04931556-9.10222222-7.97354666a108.06158222 108.06158222 0 0 0-152.48042666 0 108.06158222 108.06158222 0 0 0 0 152.48042666v1.12867556l298.11598222 294.69354666 2.25735111 1.12867556 1.12867555 2.29376a302.44864 302.44864 0 0 0 182.04444445 61.42179556h62.62328889a297.46062222 297.46062222 0 0 0 298.07957333-298.11598223V439.18222222c0-59.89262222-49.37045333-109.22666667-109.22666667-109.22666667-15.51018667 0-29.85528889 4.25984-43.25376 10.23089778C787.90656 292.85489778 744.83484445 257.13777778 694.04444445 257.13777778c-27.88920889 0-53.48465778 10.92266667-72.81777778 28.43534222A108.64412445 108.64412445 0 0 0 548.40888889 257.13777778a107.40622222 107.40622222 0 0 0-36.40888889 6.84487111V111.50222222c0-59.89262222-49.33404445-109.22666667-109.22666667-109.22666667z m0 72.81777778c20.20693333 0 36.40888889 16.20195555 36.40888889 36.40888889v400.49777778h72.81777778v-145.63555555c0-20.20693333 16.20195555-36.40888889 36.40888889-36.4088889 20.20693333 0 36.40888889 16.20195555 36.40888889 36.4088889v145.63555555h72.81777777v-145.63555555c0-20.20693333 16.20195555-36.40888889 36.4088889-36.4088889 20.20693333 0 36.40888889 16.20195555 36.40888888 36.4088889v145.63555555h76.24021334v-72.81777778c0-20.20693333 16.20195555-36.40888889 36.40888888-36.40888889 20.17052445 0 36.40888889 16.20195555 36.4088889 36.40888889v284.46264889c0 126.12039111-99.14140445 225.26179555-225.29820445 225.26179556h-62.55047111c-53.33902222 0-99.43267555-19.04184889-137.69841778-47.80487112l-294.69354666-291.2711111c-16.20195555-16.20195555-16.20195555-33.86026667 0-50.06222223 16.23836445-16.20195555 33.86026667-16.20195555 50.06222222 0L366.36444445 716.8V111.50222222c0-20.20693333 16.20195555-36.40888889 36.40888888-36.40888889z"}),handler:Object(s.jsx)("path",{d:"M371.35894623 933.82683868a35.15424307 35.15424307 0 0 1-33.04498837-24.6079704l-246.07970317-773.3933517A35.15424307 35.15424307 0 0 1 100.67127268 100.67127268a35.15424307 35.15424307 0 0 1 35.1542439-8.43701798l773.3933517 246.07970316A35.15424307 35.15424307 0 0 1 933.82683868 371.35894623a35.15424307 35.15424307 0 0 1-23.90488522 35.15424308l-262.60219775 87.53406591 241.1581094 240.80656641a35.15424307 35.15424307 0 0 1 0 49.91902596l-105.46273003 105.46272922a35.15424307 35.15424307 0 0 1-49.91902516 0l-240.8065664-241.15810857L406.51318931 909.92195346A35.15424307 35.15424307 0 0 1 371.35894623 933.82683868z m105.46273004-386.69667626a35.15424307 35.15424307 0 0 1 24.95951258 10.19473049l256.27443364 256.62597583L813.95086874 758.0556225l-256.62597583-256.27443365a35.15424307 35.15424307 0 0 1-9.14010315-33.04498838 35.15424307 35.15424307 0 0 1 22.8502587-25.31105557l214.08934131-70.30848614L179.41677762 179.41677762 371.35894623 785.12438977l70.30848697-214.08934131a35.15424307 35.15424307 0 0 1 25.31105475-22.8502587A31.99036103 31.99036103 0 0 1 476.82167627 547.13016241z"})};var ct=function(){const t=Object(a.b)(),{handlerMode:e="draw"}=Object(a.c)(t=>t);return Object(s.jsx)("div",{className:"tool-bar-group",onClick:()=>t({type:"CHANGE_HANDLER_MODE",handlerMode:"handler"===e?"draw":"handler"}),children:Object(s.jsx)("svg",{className:"tool-bar-item",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",children:ot[e]},e)})};let rt=!1,at=!1,st=null,it=null;var lt=function(){const t=Object(o.useRef)(),[e,n]=Object(o.useState)({transX:0,transY:0}),{transX:c,transY:i}=e,{innerWidth:l,innerHeight:u}=window,{drawingStyle:d}=Object(a.c)(t=>t);function f(t){const{touches:[{pageX:e,pageY:n}]}=t;return{nativeEvent:{offsetX:e,offsetY:n}}}return Object(s.jsx)("div",{className:"tool-bar-wrap",style:{"--fillColor":d.color},onWheel:function(e){const{current:n}=t;e.stopPropagation(),n.scrollTo({left:~~(n.scrollLeft+.5*e.deltaY)})},ref:t,children:Object(s.jsxs)("div",{className:"tool-bar ".concat(Math.abs(c)>l/12?"collapsed":""," ").concat(Math.abs(i)>u/2?"tool-bar-up":""),onTouchEnd:function(){rt=!1,at=!1;const t=Math.abs(c),e=Math.abs(i);n({transX:t>l/12?t/c*(l/2-50):0,transY:e>u/2?100-u:0})},onTouchMove:function(t){rt?function(t){if(!at)return;const{nativeEvent:e}=t,{offsetX:o,offsetY:r}=e,a=c+o-st,s=i+r-it;st=o,it=r,n({transX:a,transY:s})}(f(t)):(rt=!0,function(t){at=!0;const{nativeEvent:e}=t;st=e.offsetX,it=e.offsetY}(f(t)))},style:{transform:"translate("+c+"px, "+i+"px)",transition:rt?"width .2s":"transform .3s,width .2s",width:Math.abs(c)>l/12?"50px":"350px"},children:[Object(s.jsx)(ct,{}),Object(s.jsx)(q,{}),Object(s.jsx)(Q,{}),Object(s.jsx)($,{}),Object(s.jsx)(nt,{}),Object(s.jsx)("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",className:"tool-bar-item collapsed-indicator",onClick:function(){n(Object(r.a)(Object(r.a)({},e),{},{transX:0}))},children:K[d.type].path})]})})};var ut=function(){return Object(s.jsxs)(o.Fragment,{children:[Object(s.jsx)(P,{}),Object(s.jsx)(lt,{})]})},dt=n(11);const ft="drawingBoard:drawingStyle",ht={figures:[],drawingStyle:localStorage.getItem(ft)?JSON.parse(localStorage.getItem(ft)):{type:"path",color:"orange",width:2,fill:"transparent"}};const pt=Object(dt.a)(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht,e=arguments.length>1?arguments[1]:void 0;const{type:n}=e;if("INIT_FIGURES"===n)return e.figures.forEach(e=>t.figures.push(e)),et.addStatus(t.figures),Object(r.a)({},t);if("ADD_NEW_FIGURE"===n)return t.figures.push(e.figure),et.addStatus(t.figures),Object(r.a)({},t);if("SET_DRAWING_STYLE"===n)return t.drawingStyle=e.style,localStorage.setItem(ft,JSON.stringify(t.drawingStyle)),Object(r.a)({},t);if("SET_ACTIVE_SELECTOR"===n)return t.activeSelector=e.activeSelector,Object(r.a)({},t);if("CHANGE_HANDLER_MODE"===n)return t.handlerMode=e.handlerMode,Object(r.a)({},t);if("CLEAR_FIGURES"===n)return et.clearAllStack(),t.figures=[],Object(r.a)({},t);if("BACK_TO"===n){const e=et.backStatus();if(e)return t.figures=[...e],Object(r.a)({},t)}else if("RECOVER_TO"===n){const e=et.recStatus();if(e)return t.figures=[...e],Object(r.a)({},t)}return t});var bt=pt;var jt,gt=t=>{t&&t instanceof Function&&n.e(3).then(n.bind(null,23)).then(e=>{let{getCLS:n,getFID:o,getFCP:c,getLCP:r,getTTFB:a}=e;n(t),o(t),c(t),r(t),a(t)})};jt="drawing-board",c.default.render(Object(s.jsx)(o.default.StrictMode,{children:Object(s.jsx)(a.a,{store:bt,children:Object(s.jsx)(ut,{})})}),document.getElementById(jt)),gt()}],[[21,1,2]]]);
//# sourceMappingURL=main.09334810.chunk.js.map