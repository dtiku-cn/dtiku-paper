{%- import "macros/general.html.min.jinja" as general -%}
{%- import "macros/artalk.html.min.jinja" as artalk -%}
{%- import "macros/painter.html.min.jinja" as painter -%}
{%- import "macros/issue.html.min.jinja" as issue -%}
<!doctype html>
<html lang="zh">

<head>
    {% call general::meta() %}
    <title>{{issue.title}} - 论坛交流 | {{global.config.site_title}}</title>
    {% call general::headerfiles() %}
    {% call issue::issue_detail_style() %}
</head>

<body class="container">
    {% call general::header() %}
    <div class="d-flex">
        <aside class="card-header py-2 pl-3 pr-2">
            <header class="d-flex align-items-center">
                <svg class="icon-svg icon-svg-md mr-2 d-print-none">
                    <use xlink:href="#{{issue.topic.icon()}}"></use>
                </svg>
                <strong class="d-none d-md-block d-print-none">【{{issue.topic.text()}}】</strong>
                <strong class="mr-auto">{{issue.title}}</strong>
            </header>
            <div></div>
        </aside>
        <div id="toc" class="card-body vditor-reset">{{issue.html|safe}}</div>
    </div>
    <footer class="card-footer d-flex align-items-center d-print-none">
        <div class="d-flex align-items-center mr-auto">
            {% if let Some(u)=issue.user %}
            <img id="{{u.id}}" class="border rounded-circle mr-2" style="height:2em" data-toggle="tooltip"
                src="{{u.avatar}}" title="{{u.name}}" alt="{{u.name}}" />
            {% endif %}
            <b class="d-none d-md-block">{{issue.author_name()}}</b>
            <span data-toggle="tooltip"
                title='{{global.format(issue.created, "%Y-%m-%d %H:%M")}}'>发布于{{global.format_with_now(issue.created)}}</span>
            {% if issue.created != issue.modified %}
            <span class="d-none d-sm-block">&nbsp; | &nbsp;</span>
            <span class="d-none d-sm-block" data-toggle="tooltip"
                title='{{global.format(issue.modified, "%Y-%m-%d %H:%M")}}'>更新于{{global.format_with_now(issue.modified)}}</span>
            {% endif %}
        </div>
        <div class="artalk-page-vote d-flex">
            <a id="agree" class="card-link d-flex align-items-center artalk-page-vote-up" title="赞同数"
                data-toggle="{%if global.user.is_none()%}modal{%else%}tooltip{%endif%}"
                href="{%if global.user.is_none()%}#loginModal{%else%}javascript:void(0){%endif%}">
                <svg class="icon-svg icon-svg-md mr-2">
                    <use xlink:href="#ic-agree"></use>
                </svg>
                <b class="agree-count artalk-page-vote-up-count"></b>
            </a>
            <a id="disagree" class="card-link d-flex align-items-center artalk-page-vote-down" title="反对数"
                data-toggle="{%if global.user.is_none()%}modal{%else%}tooltip{%endif%}"
                href="{%if global.user.is_none()%}#loginModal{%else%}javascript:void(0){%endif%}">
                <svg class="icon-svg icon-svg-md mr-2">
                    <use xlink:href="#ic-disagree"></use>
                </svg>
                <b class="agree-count artalk-page-vote-down-count"></b>
            </a>
        </div>
    </footer>
    <div id='toc-table' class='d-print-none'></div>
    {% call artalk::comment(true,true,true,"来这里吐槽一下")%}
    {% call general::footer() %}
    {% call issue::issue_detail_script() %}
    {# painter要放在window.floatButtonAddon下面加载 #}
    {% call painter::painter() %}
</body>

</html>